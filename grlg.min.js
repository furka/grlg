!function(){"use strict";function a(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}function b(a){return a=parseFloat(a)||0,a=Math.max(0,a),a=Math.min(1,a)}function c(a,b,c,d){var e,f=[];d=parseInt(d,10)||Math.floor(4*Math.random());for(var g=0,h=l.length;h>g;g+=1)e=(g+d)%h,"undefined"==typeof a.get(b+l[e].x,c+l[e].y)&&f.push(e);return f}function d(a){return a._activeIndexes.splice(Math.floor(Math.random()*a._activeIndexes.length),1)[0]}function e(a){for(var b,d,e,f=a._history.length-1;f>=0;f-=1){if(e=a._history[f],b=e%a.width,d=Math.floor(e/a.width),b>0&&b<a.width-1&&d>0&&d<a.height-1&&c(a,b,d).length)return a._cells[e]=!0,a._activeIndexes.push(e),e;a._history.splice(f,0)}}function f(a){a.first=j(a,a.settings.start.x,a.settings.start.y)}function g(b,g,m,n,o){if(b.completed)return!1;if(!b.first)return f(b),!0;var p=b.openCount<g,q=m&&b.openCount>=m;if(!b._activeIndexes.length){if(!p)return!1;if(!e(b))return!1}var r,s=d(b),t=s%b.width,u=Math.floor(s/b.width),v=b._propagationDirections[s];Math.random()>o&&(v=void 0);var w,x=c(b,t,u,v);for(h(x,b,t,u),p&&(void 0===x[0]&&(x=a(x)),i(x,b,t,u)),x=a(x),r=x.length-1;r>=0;r-=1)void 0!==x[r]&&(w=l[x[r]],!q&&Math.random()<=n?j(b,w.x+t,w.y+u,x[r]):k(b,w.x+t,w.y+u,x[r]));return!0}function h(a,b,c,d){for(var e,f=a.length-1;f>=0;f-=1)e=l[a[f]],(e.x+c<=0||e.x+c>=b.width-1||e.y+d<=0||e.y+d>=b.height-1)&&(k(b,e.x+c,e.y+d,a[f]),a[f]=void 0)}function i(a,b,c,d){for(var e,f=0;f<a.length;f+=1)if(void 0!==a[f])return e=l[a[f]],j(b,e.x+c,e.y+d,a[f]),void(a[f]=void 0)}function j(a,b,c,d){a.openCount+=1;var e=b+c*a.width;return a._cells[e]=!0,a._propagationDirections[e]=d,a._activeIndexes.push(e),a.last=e,e}function k(a,b,c,d){var e=b+c*a.width;return a._cells[e]=!1,a._propagationDirections[e]=d,a._history.push(e),e}var l=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}],m={max:void 0,min:20,speed:1,linearity:0,density:0},n=function(a,b){a=Math.floor(a||0),b=Math.floor(b||0),this.width=a,this.height=b,this._cells=[],this._history=[],this._activeIndexes=[],this._propagationDirections=[],this.settings={};for(var c in m)this.settings[c]=m[c];this.settings.start={x:Math.floor(this.width/2),y:Math.floor(this.height/2)},this.openCount=0};if(n.prototype.get=function(a,b){return a=Math.floor(a),b=Math.floor(b),this._cells[a+b*this.width]},n.prototype.getStart=function(){return{x:this.first%this.width,y:Math.floor(this.first/this.height)}},n.prototype.getEnd=function(){return{x:this.last%this.width,y:Math.floor(this.last/this.height)}},n.prototype.generate=function(){for(var a=0;a<this.settings.speed&&!this.completed;a+=1)this.completed=!g(this,this.settings.min,this.settings.max,this.settings.density,this.settings.linearity);this.completed&&(delete this._history,delete this._propagationDirections,delete this._activeIndexes)},n.prototype.generateAll=function(a,b){this.generate(),"function"==typeof b&&b(this),this.completed?"function"==typeof a&&a(this):setTimeout(this.generateAll.bind(this,a,b),10)},n.prototype.configure=function(a){if("object"==typeof a){for(var c in this.settings)this.settings[c]=a[c]||this.settings[c];this.settings.start=this.settings.start||{},this.settings.start.x=Math.floor(Math.max(1,Math.min(this.settings.start.x,this.width-2)))||Math.floor(this.width/2),this.settings.start.y=Math.floor(Math.max(1,Math.min(this.settings.start.y,this.height-2)))||Math.floor(this.height/2),this.settings.density=b(this.settings.density),this.settings.linearity=b(this.settings.linearity),this.settings.speed=Math.max(1,parseInt(this.settings.speed,10)||1),this.settings.min=Math.max(0,parseInt(this.settings.min,10)||0),this.settings.max=Math.max(this.settings.min,parseInt(this.settings.max,10))||void 0}},n.prototype.config=n.prototype.configure,n.prototype.print=function(a,b){b=b||document.createElement("canvas");var c,d,e=b.getContext("2d");a=a||5,b.width=this.width*a,b.height=this.height*a,e.strokeStyle="rgba(200,200,200,1)";for(var f=0;f<this._cells.length;f+=1)"undefined"!=typeof this._cells[f]&&(c=f%this.width,d=Math.floor(f/this.width),f===this.first?e.fillStyle="rgba(0,255,255,1)":f===this.last?e.fillStyle="rgba(255,0,255,1)":this._cells[f]?e.fillStyle="rgba(255,255,255,1)":e.fillStyle="rgba(50,50,50,1)",e.fillRect(c*a,d*a,a,a),a>3&&e.strokeRect(c*a+.5,d*a+.5,a,a));return b},"undefined"!=typeof module&&module.exports)module.exports=n;else if("function"==typeof define&&define.amd)define("grlg",[],function(){return n});else{var o="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;o.GRLG=n}}();