!function(){"use strict";function a(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}function b(a){return a=parseFloat(a)||0,a=Math.max(0,a),a=Math.min(1,a)}function c(a,b,c,d){var e,f=[];d=parseInt(d,10)||Math.floor(4*Math.random());for(var g=0,h=i.length;h>g;g+=1)e=(g+d)%h,"undefined"==typeof a.get(b+i[e].x,c+i[e].y)&&f.push(e);return f}function d(a){return a._activeIndexes.splice(Math.floor(Math.random()*a._activeIndexes.length),1)[0]}function e(a){for(var b,d,e,f=a._history.length-1;f>=0;f-=1)if(e=a._history[f],b=e%a.width,d=Math.floor(e/a.height),b>0&&b<a.width-1&&d>0&&d<a.height-1&&c(a,b,d).length)return a._cells[e]=!0,a._activeIndexes.push(e),e}function f(b,f,j,k,l){if(b.completed)return!1;var m=b.openCount<f,n=j&&b.openCount>=j;if(!b._activeIndexes.length){if(!m)return!1;if(!e(b))return!1}var o,p=d(b),q=p%b.width,r=Math.floor(p/b.height),s=b._propagationDirections[p];Math.random()>l&&(s=void 0);var t,u=c(b,q,r,s);for(o=u.length-1;o>=0;o-=1)t=i[u[o]],(t.x+q<=0||t.x+q>=b.width-1||t.y+r<=0||t.y+r>=b.height-1)&&(h(b,t.x+q,t.y+r,u[o]),u.splice(o,1));if(!u.length)return!0;for(m&&(t=i[u[0]],g(b,t.x+q,t.y+r,u[0]),u.splice(0,1)),u=a(u),o=u.length-1;o>=0;o-=1)t=i[u[o]],!n&&Math.random()<=k?g(b,t.x+q,t.y+r,u[o]):h(b,t.x+q,t.y+r,u[o]);return!0}function g(a,b,c,d){a.openCount+=1;var e=b+c*a.width;return a._cells[e]=!0,a._propagationDirections[e]=d,a._activeIndexes.push(e),a._history.push(e),a.last=e,e}function h(a,b,c,d){var e=b+c*a.width;return a._cells[e]=!1,a._propagationDirections[e]=d,a._history.push(e),e}var i=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}],j={max:void 0,min:20,speed:1,linearity:0,density:0},k=function(a,b){a=Math.floor(a||0),b=Math.floor(b||0),this.width=a,this.height=b,this._cells=[],this._history=[],this._activeIndexes=[],this._propagationDirections=[],this.settings={};for(var c in j)this.settings[c]=j[c];this.openCount=0,this.first=g(this,this.width/2,this.height/2)};if(k.prototype.get=function(a,b){return a=Math.floor(a),b=Math.floor(b),this._cells[a+b*this.width]},k.prototype.generate=function(){for(var a=0;a<this.settings.speed;a+=1)if(this.completed=!f(this,this.settings.min,this.settings.max,this.settings.density,this.settings.linearity),this.completed)return},k.prototype.generateAll=function(a,b){this.generate(),"function"==typeof b&&b(this),this.completed?"function"==typeof a&&a(this):setTimeout(this.generateAll.bind(this,a,b),10)},k.prototype.configure=function(a){if("object"==typeof a){for(var c in this.settings)this.settings[c]=a[c]||this.settings[c];this.settings.density=b(this.settings.density),this.settings.linearity=b(this.settings.linearity),this.settings.speed=Math.max(1,parseInt(this.settings.speed,10)||1),this.settings.min=Math.max(0,parseInt(this.settings.min,10)||0),this.settings.max=Math.max(this.settings.min,parseInt(this.settings.max,10))||void 0}},k.prototype.print=function(a,b){b=b||document.createElement("canvas");var c,d,e=b.getContext("2d");a=a||5,b.width=this.width*a,b.height=this.height*a,e.strokeStyle="rgba(200,200,200,1)";for(var f=0;f<this._cells.length;f+=1)"undefined"!=typeof this._cells[f]&&(c=f%this.width,d=Math.floor(f/this.height),f===this.first?e.fillStyle="rgba(0,255,255,1)":f===this.last?e.fillStyle="rgba(255,0,255,1)":this._cells[f]?e.fillStyle="rgba(255,255,255,1)":e.fillStyle="rgba(50,50,50,1)",e.fillRect(c*a,d*a,a,a),a>3&&e.strokeRect(c*a+.5,d*a+.5,a,a));return b},"undefined"!=typeof module&&module.exports)module.exports=k;else if("function"==typeof define&&define.amd)define("grlg",[],function(){return k});else{var l="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;l.GRLG=k}}();