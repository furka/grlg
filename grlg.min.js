!function(){"use strict";function a(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}var b=function(a,b){a=Math.floor(a||0),b=Math.floor(b||0),this.width=a,this.height=b,this._cells=[],this._openCells=[],this._activeIndexes=[]};b.prototype.get=function(a,b){return a=Math.floor(a),b=Math.floor(b),this._cells[a+b*this.width]},b.prototype.isOpen=function(a,b){return a=Math.floor(a),b=Math.floor(b),!!this._openCells[a+b*this.width]};var c=[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1}];b.prototype._getOpenDirections=function(a,b){for(var d=[],e=0;e<c.length;e+=1)this.get(a+c[e].x,b+c[e].y)||d.push({x:a+c[e].x,y:b+c[e].y});return d},b.prototype._grabActiveIndex=function(){return this._activeIndexes.splice(Math.floor(Math.random()*this._activeIndexes.length),1)[0]},b.prototype.open=function(a,b){return{x:a,y:b}},b.prototype.close=b.prototype.open,b.prototype._open=function(a,b){this.openCount+=1;var c=a+b*this.width;return this._cells[c]=this.open(a,b),this._openCells[c]=!0,this._activeIndexes.push(c),this.last=c,c},b.prototype._close=function(a,b){var c=a+b*this.width;return this._cells[c]=this.close(a,b),c},b.prototype.generate=function(a,b,c){a=a||{},a.density=Number(a.density)||0,a.density=Math.max(0,a.density),a.density=Math.min(1,a.density),a.speed=parseInt(a.speed,10)||1,a.min=parseInt(a.min,10)||20,a.max=parseInt(a.max,10),a.max=Math.max(a.min,a.max),this._activeIndexes.length=this._openCells.length=this._cells.length=0,this.openCount=0,this.first=this._open(this.width/2,this.height/2),this._generateStep(a,b,c)},b.prototype._generateStep=function(a,b,c){for(var d=0;d<a.speed;d+=1)this._propagate(a.min,a.max,a.density);this._activeIndexes.length?setTimeout(this._generateStep.bind(this,a,b,c,!0),10):"function"==typeof b&&b(this),"function"==typeof c&&c(this)},b.prototype._propagate=function(b,c,d){if(this._activeIndexes.length){var e,f=this.openCount<b,g=c&&this.openCount>=c,h=this._grabActiveIndex(),i=h%this.width,j=Math.floor(h/this.height),k=this._getOpenDirections(i,j);for(e=k.length-1;e>=0;e-=1)(0===k[e].x||k[e].x===this.width-1||0===k[e].y||k[e].y===this.height-1)&&(this._close(k[e].x,k[e].y),k.splice(e,1));if(k.length)for(k=a(k),f&&(this._open(k[0].x,k[0].y),k.splice(0,1)),e=k.length-1;e>=0;e-=1)!g&&Math.random()<=d?this._open(k[e].x,k[e].y):this._close(k[e].x,k[e].y)}},b.prototype.print=function(a,b){b=b||document.createElement("canvas");var c,d,e=b.getContext("2d");a=a||5,b.width=this.width*a,b.height=this.height*a,e.strokeStyle="rgba(200,200,200,1)";for(var f=0;f<this._cells.length;f+=1)this._cells[f]&&(c=f%this.width,d=Math.floor(f/this.height),f===this.first?e.fillStyle="rgba(0,255,255,1)":f===this.last?e.fillStyle="rgba(255,0,255,1)":this.isOpen(c,d)?e.fillStyle="rgba(255,255,255,1)":e.fillStyle="rgba(50,50,50,1)",e.fillRect(c*a,d*a,a,a),a>3&&e.strokeRect(c*a+.5,d*a+.5,a,a));return b},define([],function(){return b})}();