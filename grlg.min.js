!function(){"use strict";function a(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}function b(a,b,c,d){var e,f=[];d=parseInt(d,10)||Math.floor(4*Math.random());for(var g=0,i=h.length;i>g;g+=1)e=(g+d)%i,"undefined"==typeof a.get(b+h[e].x,c+h[e].y)&&f.push(e);return f}function c(a){return a._activeIndexes.splice(Math.floor(Math.random()*a._activeIndexes.length),1)[0]}function d(a){for(var c,d,e,f=a._history.length-1;f>=0;f-=1)if(e=a._history[f],c=e%a.width,d=Math.floor(e/a.height),c>0&&c<a.width-1&&d>0&&d<a.height-1&&b(a,c,d).length)return a._cells[e]=!0,a._activeIndexes.push(e),e}function e(e,i,j,k,l){if(e.completed)return!1;var m=e.openCount<i,n=j&&e.openCount>=j;if(!e._activeIndexes.length){if(!m)return!1;if(!d(e))return!1}var o,p=c(e),q=p%e.width,r=Math.floor(p/e.height),s=e._propagationDirections[p];Math.random()>l&&(s=void 0);var t,u=b(e,q,r,s);for(o=u.length-1;o>=0;o-=1)t=h[u[o]],(t.x+q<=0||t.x+q>=e.width-1||t.y+r<=0||t.y+r>=e.height-1)&&(g(e,t.x+q,t.y+r,u[o]),u.splice(o,1));if(!u.length)return!0;for(m&&(t=h[u[0]],f(e,t.x+q,t.y+r,u[0]),u.splice(0,1)),u=a(u),o=u.length-1;o>=0;o-=1)t=h[u[o]],!n&&Math.random()<=k?f(e,t.x+q,t.y+r,u[o]):g(e,t.x+q,t.y+r,u[o]);return!0}function f(a,b,c,d){a.openCount+=1;var e=b+c*a.width;return a._cells[e]=!0,a._propagationDirections[e]=d,a._activeIndexes.push(e),a._history.push(e),a.last=e,e}function g(a,b,c,d){var e=b+c*a.width;return a._cells[e]=!1,a._propagationDirections[e]=d,a._history.push(e),e}var h=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}],i={max:void 0,min:20,speed:1,linearity:0,density:0},j=function(a,b){a=Math.floor(a||0),b=Math.floor(b||0),this.width=a,this.height=b,this._cells=[],this._history=[],this._activeIndexes=[],this._propagationDirections=[],this.settings={};for(var c in i)this.settings[c]=i[c];this.openCount=0,this.first=f(this,this.width/2,this.height/2)};if(j.prototype.get=function(a,b){return a=Math.floor(a),b=Math.floor(b),this._cells[a+b*this.width]},j.prototype.generate=function(){if(!this.completed)for(var a=0;a<this.settings.speed;a+=1)this.completed=!e(this,this.settings.min,this.settings.max,this.settings.density,this.settings.linearity)},j.prototype.generateAll=function(a,b){this.generate(),"function"==typeof b&&b(this),this.completed?"function"==typeof a&&a(this):setTimeout(this.generateAll.bind(this,a,b),10)},j.prototype.configure=function(a){if("object"==typeof a)for(var b in this.settings)this.settings[b]=a[b]||this.settings[b]},j.prototype.print=function(a,b){b=b||document.createElement("canvas");var c,d,e=b.getContext("2d");a=a||5,b.width=this.width*a,b.height=this.height*a,e.strokeStyle="rgba(200,200,200,1)";for(var f=0;f<this._cells.length;f+=1)"undefined"!=typeof this._cells[f]&&(c=f%this.width,d=Math.floor(f/this.height),f===this.first?e.fillStyle="rgba(0,255,255,1)":f===this.last?e.fillStyle="rgba(255,0,255,1)":this._cells[f]?e.fillStyle="rgba(255,255,255,1)":e.fillStyle="rgba(50,50,50,1)",e.fillRect(c*a,d*a,a,a),a>3&&e.strokeRect(c*a+.5,d*a+.5,a,a));return b},"undefined"!=typeof module&&module.exports)module.exports=j;else if("function"==typeof define&&define.amd)define("grlg",[],function(){return j});else{var k="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;k.GRLG=j}}();